(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{417:function(t,s,a){"use strict";a.r(s);var e=a(43),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"使用github-pages-vuepress-travis实现自动化部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用github-pages-vuepress-travis实现自动化部署"}},[t._v("#")]),t._v(" 使用Github Pages + Vuepress + Travis实现自动化部署")]),t._v(" "),a("h2",{attrs:{id:"构建vuepress"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建vuepress"}},[t._v("#")]),t._v(" 构建Vuepress")]),t._v(" "),a("p",[t._v("参考"),a("a",{attrs:{href:"https://vuepress.vuejs.org/zh/",target:"_blank",rel:"noopener noreferrer"}},[t._v("vuepress官网"),a("OutboundLink")],1),t._v("构建一个本地项目")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 新建项目目录")]),t._v("\nmkdir my"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("blog "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" cd my"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("blog\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化")]),t._v("\nnpm init "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("y\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 安装依赖")]),t._v("\nnpm i vuepress "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("D")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 更新scripts")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dev"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vuepress dev ."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vuepress build ."')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 新建 markdown 首页文件")]),t._v("\necho "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'# Hello Vuepress'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("README")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("md\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 启动本地服务")]),t._v("\nnpm run dev\n")])])]),a("p",[t._v("通过"),a("code",[t._v("npm run dev")]),t._v("和"),a("code",[t._v("npm run build")]),t._v("在本地运行和构建。具体如何配置"),a("code",[t._v("vuepress")]),t._v("，请自行查阅"),a("a",{attrs:{href:"https://vuepress.vuejs.org/zh/",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"配置github-token"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置github-token"}},[t._v("#")]),t._v(" 配置github token")]),t._v(" "),a("p",[t._v("要使用"),a("code",[t._v("travis")]),t._v("自动化部署，"),a("code",[t._v("travis")]),t._v("就需要读取你的"),a("code",[t._v("github")]),t._v("的"),a("code",[t._v("repo")]),t._v("。"),a("code",[t._v("github")]),t._v("提供了"),a("code",[t._v("token")]),t._v("机制供外部访问你的仓库。")]),t._v(" "),a("p",[t._v("进入"),a("a",{attrs:{href:"https://github.com/settings/tokens",target:"_blank",rel:"noopener noreferrer"}},[t._v("github token"),a("OutboundLink")],1),t._v("，生成一个供"),a("code",[t._v("travis")]),t._v("用的token，token的权限暂时全选，token注意保密且需要安全保存")]),t._v(" "),a("h2",{attrs:{id:"配置travis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置travis"}},[t._v("#")]),t._v(" 配置Travis")]),t._v(" "),a("p",[t._v("使用github账号登陆"),a("a",{attrs:{href:"https://travis-ci.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("travis"),a("OutboundLink")],1),t._v(",点击左侧"),a("code",[t._v("+")]),t._v("配置需要同步的仓库。\n在仓库选择列表打开需要同步的仓库的开关，并点击设置按钮进行配置。在环境变量("),a("code",[t._v("Environment Variables")]),t._v(")中添加一栏我们刚才获取的"),a("code",[t._v("token")]),t._v(","),a("code",[t._v("name")]),t._v("为键名("),a("em",[t._v("过会有用")]),t._v("),"),a("code",[t._v("value")]),t._v("为"),a("code",[t._v("token")]),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"编写travis配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写travis配置文件"}},[t._v("#")]),t._v(" 编写Travis配置文件")]),t._v(" "),a("p",[t._v("在"),a("code",[t._v("vuepress")]),t._v("项目根目录新建"),a("code",[t._v(".travis.yml")]),t._v("自动化构建的配置文件")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cd my-blog\ntouch .travis.yml\n")])])]),a("p",[a("code",[t._v(".travis.yml")]),t._v("配置如下：")]),t._v(" "),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("language")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" node_js\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("node_js")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" lts/*\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("install")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" yarn install \n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" yarn build \n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("deploy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("provider")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pages\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("target_branch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" master   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 发布的分支")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("skip_cleanup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("local_dir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" .vuepress/dist\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("github_token")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $blog "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在 GitHub 中生成，用于允许 Travis 向你的仓库推送代码。在 Travis 的项目设置页面进行配置的键名，设置为 secure variable")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("keep_history")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" blog    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 推送的分支")]),t._v("\n")])])]),a("p",[t._v("我们再"),a("code",[t._v("github pages")]),t._v("的同一个仓库下面，使用"),a("code",[t._v("blog")]),t._v("分支提交我们的源文件，使用"),a("code",[t._v("master")]),t._v("发布我们的博客。")]),t._v(" "),a("h2",{attrs:{id:"结束"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#结束"}},[t._v("#")]),t._v(" 结束")]),t._v(" "),a("p",[t._v("以后每次更新完博客，直接"),a("code",[t._v("push")]),t._v("到"),a("code",[t._v("blog")]),t._v("分支，"),a("code",[t._v("travis")]),t._v("会读取"),a("code",[t._v("blog")]),t._v("分支源码下的"),a("code",[t._v(".travis.yml")]),t._v("文件，自动帮我们生成并部署网站")])])}),[],!1,null,null,null);s.default=r.exports}}]);